import tkinter as tk
from tkinter import messagebox, filedialog
from PIL import Image, ImageDraw, ImageTk
import random
import os

# 预设颜色集合
preset_colors = {
    "中国500色/CN500-Color": [
    (92, 34, 35),
    (238, 162, 164),
    (90, 25, 27),
    (240, 124, 130),
    (90, 18, 22),
    (237, 90, 101),
    (192, 72, 81),
    (238, 63, 77),
    (192, 44, 56),
    (167, 83, 90),
    (227, 180, 184),
    (240, 161, 168),
    (241, 147, 156),
    (166, 27, 41),
    (137, 78, 84),
    (196, 90, 101),
    (209, 26, 45),
    (194, 31, 48),
    (222, 28, 49),
    (124, 24, 35),
    (84, 30, 36),
    (76, 31, 36),
    (130, 32, 43),
    (130, 17, 31),
    (239, 71, 93),
    (77, 16, 24),
    (237, 85, 106),
    (122, 115, 116),
    (240, 55, 82),
    (230, 210, 213),
    (240, 201, 207),
    (238, 39, 70),
    (43, 18, 22),
    (238, 72, 99),
    (231, 124, 142),
    (80, 10, 22),
    (194, 124, 136),
    (115, 87, 92),
    (238, 72, 102),
    (98, 22, 36),
    (206, 87, 119),
    (204, 22, 58),
    (241, 196, 205),
    (238, 184, 195),
    (133, 109, 114),
    (45, 12, 19),
    (54, 40, 43),
    (191, 53, 83),
    (236, 155, 173),
    (99, 7, 28),
    (48, 22, 28),
    (238, 166, 183),
    (233, 204, 211),
    (235, 160, 179),
    (79, 56, 62),
    (237, 157, 178),
    (236, 138, 164),
    (236, 118, 150),
    (234, 114, 147),
    (239, 130, 160),
    (236, 44, 100),
    (235, 80, 126),
    (235, 60, 112),
    (234, 81, 127),
    (222, 120, 151),
    (181, 152, 161),
    (237, 47, 106),
    (197, 112, 139),
    (51, 20, 30),
    (98, 29, 52),
    (239, 52, 115),
    (56, 33, 41),
    (49, 15, 27),
    (56, 25, 36),
    (225, 108, 150),
    (149, 28, 72),
    (98, 16, 46),
    (224, 200, 209),
    (209, 60, 116),
    (75, 30, 47),
    (236, 78, 138),
    (222, 63, 124),
    (168, 69, 107),
    (206, 94, 138),
    (70, 22, 41),
    (238, 44, 121),
    (239, 73, 139),
    (237, 227, 231),
    (236, 45, 122),
    (72, 41, 54),
    (68, 14, 37),
    (210, 86, 140), 
    (233, 215, 223),
    (210, 53, 125),
    (54, 41, 47),
    (210, 118, 163),
    (192, 111, 152),
    (204, 85, 149),
    (195, 86, 145),
    (186, 47, 123),
    (155, 30, 100),
    (93, 63, 81),
    (78, 42, 64),
    (188, 132, 168),
    (192, 142, 175),
    (65, 28, 53),
    (173, 101, 152),
    (163, 92, 143),
    (104, 23, 82),
    (137, 66, 118),
    (126, 32, 101),
    (139, 38, 113),
    (152, 54, 128),
    (200, 173, 196),
    (28, 13, 26),
    (126, 22, 113),
    (30, 19, 29),
    (129, 60, 133),
    (209, 194, 211),
    (62, 56, 65),
    (129, 92, 148),
    (128, 109, 158),
    (226, 225, 228),
    (50, 47, 59),
    (128, 118, 163),
    (53, 51, 60),
    (34, 32, 46),
    (19, 17, 36),
    (48, 47, 75),
    (82, 82, 136),
    (47, 47, 53),
    (204, 204, 214),
    (116, 117, 155),
    (31, 32, 64),
    (46, 49, 124),
    (167, 168, 189),
    (97, 100, 159),
    (45, 46, 54),
    (94, 97, 109),
    (71, 72, 76),
    (15, 20, 35),
    (19, 24, 36),
    (71, 81, 100),
    (43, 51, 62),
    (28, 41, 56),
    (16, 31, 48),
    (20, 35, 52),
    (21, 85, 154),
    (15, 89, 164),
    (22, 97, 171),
    (49, 112, 167),
    (52, 108, 156),
    (39, 117, 182),
    (43, 115, 175),
    (36, 116, 181),
    (78, 124, 161),
    (35, 118, 183),
    (20, 74, 116),
    (147, 181, 207),
    (33, 119, 184),
    (18, 107, 174),
    (23, 114, 180),
    (186, 204, 217),
    (97, 154, 195),
    (73, 92, 105),
    (143, 178, 201),
    (86, 152, 195),
    (17, 101, 154),
    (41, 131, 187),
    (22, 119, 179),
    (196, 203, 207),
    (17, 119, 176),
    (36, 134, 185),
    (94, 121, 135),
    (116, 120, 122),
    (205, 209, 211),
    (23, 129, 181),
    (102, 169, 201),
    (208, 223, 230),
    (47, 144, 185),
    (138, 188, 209),
    (195, 215, 223),
    (21, 139, 184),
    (216, 227, 231),
    (178, 187, 190),
    (26, 148, 188),
    (92, 179, 204),
    (19, 72, 87),
    (19, 44, 51),
    (33, 55, 61),
    (176, 213, 223),
    (34, 162, 195),
    (71, 75, 76),
    (99, 187, 208),
    (18, 110, 130),
    (15, 149, 176),
    (20, 145, 168),
    (199, 210, 212),
    (30, 158, 179),
    (59, 129, 140),
    (14, 176, 201),
    (41, 183, 203),
    (81, 196, 211),
    (124, 171, 177),
    (16, 174, 194),
    (100, 142, 147),
    (147, 213, 220),
    (97, 113, 114),
    (198, 230, 232),
    (134, 157, 157),
    (87, 195, 194),
    (196, 215, 214),
    (18, 170, 156),
    (115, 124, 123),
    (18, 161, 130),
    (27, 167, 132),
    (66, 134, 117),
    (192, 196, 195),
    (36, 128, 103),
    (26, 59, 50),
    (49, 74, 67),
    (44, 150, 120),
    (34, 62, 54),
    (73, 117, 104),
    (20, 30, 27),
    (105, 167, 148),
    (43, 174, 133),
    (154, 190, 175),
    (69, 183, 135),
    (146, 179, 165),
    (31, 38, 35),
    (131, 203, 172),
    (112, 136, 125),
    (85, 187, 138),
    (32, 161, 98),
    (64, 160, 112),
    (26, 104, 64),
    (97, 172, 133),
    (104, 184, 142),
    (164, 202, 182),
    (60, 149, 102),
    (93, 190, 138),
    (32, 127, 76),
    (238, 247, 242),
    (87, 149, 114),
    (185, 222, 201),
    (34, 148, 83),
    (32, 137, 77),
    (21, 35, 27),
    (102, 193, 140),
    (164, 172, 167),
    (138, 152, 142),
    (158, 204, 171),
    (131, 167, 141),
    (72, 91, 77),
    (93, 101, 95),
    (110, 139, 116),
    (43, 49, 44),
    (198, 223, 200),
    (65, 179, 73),
    (67, 178, 68),
    (37, 61, 36),
    (65, 174, 60),
    (173, 213, 162),
    (94, 102, 91),
    (140, 194, 105),
    (91, 174, 35),
    (223, 236, 213),
    (202, 211, 195),
    (159, 163, 154),
    (178, 207, 135),
    (150, 194, 78),
    (240, 245, 229),
    (183, 208, 122),
    (208, 222, 170),
    (55, 56, 52),
    (186, 207, 101),
    (226, 231, 191),
    (190, 201, 54),
    (210, 217, 122),
    (226, 216, 73),
    (255, 254, 248),
    (94, 83, 20),
    (255, 254, 249),
    (173, 158, 95),
    (254, 215, 26),
    (249, 244, 220),
    (228, 191, 17),
    (210, 177, 22),
    (251, 218, 65),
    (238, 208, 69),
    (241, 202, 23),
    (210, 180, 44),
    (242, 206, 43),
    (226, 192, 39),
    (100, 88, 34),
    (252, 210, 23),
    (248, 223, 112),
    (223, 194, 67),
    (248, 223, 114),
    (255, 209, 17),
    (221, 200, 113),
    (255, 254, 250),
    (134, 112, 24),
    (136, 115, 34),
    (252, 211, 55),
    (142, 128, 75),
    (254, 204, 17),
    (252, 203, 22),
    (255, 201, 12),
    (183, 174, 143),
    (248, 216, 106),
    (251, 205, 49),
    (252, 195, 7),
    (233, 221, 182),
    (252, 197, 21),
    (247, 232, 170),
    (232, 176, 4),
    (249, 193, 22),
    (249, 215, 112),
    (251, 200, 47),
    (241, 240, 237),
    (91, 73, 19),
    (246, 196, 48),
    (183, 141, 18),
    (249, 189, 16),
    (249, 211, 103),
    (217, 164, 14),
    (235, 177, 13),
    (88, 71, 23),
    (247, 222, 152),
    (249, 241, 219),
    (244, 206, 105),
    (254, 186, 7),
    (138, 105, 19),
    (135, 104, 24),
    (182, 164, 118),
    (252, 183, 10),
    (240, 214, 149),
    (135, 114, 62),
    (248, 232, 193),
    (214, 160, 29),
    (247, 218, 148),
    (234, 173, 26),
    (251, 182, 18),
    (181, 170, 144),
    (247, 244, 237),
    (248, 188, 49),
    (183, 139, 38),
    (229, 211, 170),
    (105, 94, 69),
    (229, 183, 81),
    (243, 191, 76),
    (104, 94, 72),
    (251, 185, 41),
    (249, 210, 125),
    (226, 193, 124),
    (180, 169, 146),
    (246, 222, 173),
    (242, 230, 206),
    (248, 224, 176),
    (57, 55, 51),
    (131, 94, 29),
    (248, 244, 237),
    (252, 161, 4),
    (129, 95, 37),
    (252, 161, 6),
    (255, 166, 15),
    (128, 99, 50),
    (251, 242, 227),
    (251, 164, 20),
    (228, 223, 215),
    (130, 107, 72),
    (218, 212, 203),
    (187, 181, 172),
    (187, 181, 172),
    (255, 153, 0),
    (251, 185, 87),
    (220, 145, 35),
    (192, 147, 81),
    (244, 168, 58),
    (247, 193, 115),
    (231, 162, 63),
    (83, 60, 27),
    (249, 232, 208),
    (222, 158, 68),
    (249, 203, 139),
    (249, 166, 51),
    (218, 164, 90),
    (85, 59, 24),
    (81, 60, 32),
    (152, 101, 36),
    (151, 132, 108),
    (227, 189, 141),
    (77, 64, 48),
    (251, 139, 5),
    (248, 195, 135),
    (242, 142, 22),
    (80, 62, 42),
    (74, 64, 53),
    (207, 204, 201),
    (193, 178, 163),
    (134, 126, 118),
    (132, 124, 116), 
    (252, 140, 35),
    (251, 236, 222),
    (79, 64, 50),
    (251, 238, 226),
    (129, 119, 110),
    (154, 136, 120),
    (93, 61, 33),
    (102, 70, 42),
    (145, 128, 114),
    (217, 145, 86),
    (193, 101, 26),
    (212, 196, 183),
    (190, 126, 74),
    (92, 55, 25),
    (222, 118, 34),
    (219, 133, 64),
    (128, 118, 110),
    (240, 156, 90),
    (249, 125, 28),
    (242, 107, 31),
    (248, 179, 127),
    (250, 126, 35),
    (249, 233, 205),
    (183, 160, 145),
    (148, 88, 51),
    (240, 148, 93),
    (150, 77, 34),
    (149, 68, 22),
    (225, 103, 35),
    (252, 121, 48),
    (207, 117, 67),
    (248, 107, 29),
    (205, 98, 39),
    (246, 220, 206),
    (216, 89, 22),
    (247, 207, 186),
    (242, 118, 53),
    (228, 104, 40),
    (252, 99, 21),
    (183, 81, 29),
    (234, 137, 88),
    (232, 180, 154),
    (251, 153, 104),
    (237, 195, 174),
    (54, 52, 51),
    (139, 97, 77),
    (170, 106, 76),
    (166, 82, 44),
    (250, 93, 25),
    (113, 54, 29),
    (184, 148, 133),
    (246, 140, 96),
    (246, 173, 143),
    (115, 46, 18),
    (247, 205, 188),
    (239, 99, 43),
    (140, 75, 49),
    (100, 72, 61),
    (249, 114, 61),
    (207, 72, 19),
    (238, 128, 85),
    (248, 235, 230),
    (117, 49, 23),
    (96, 61, 48),
    (136, 58, 30),
    (177, 75, 40),
    (135, 61, 36),
    (246, 206, 193),
    (91, 66, 58),
    (98, 73, 65),
    (103, 52, 36),
    (244, 62, 6),
    (239, 111, 72),
    (244, 199, 186),
    (237, 81, 38),
    (243, 71, 24),
    (242, 72, 27),
    (101, 43, 28),
    (238, 160, 140),
    (240, 75, 34),
    (105, 42, 27),
    (241, 68, 29),
    (119, 61, 49),
    (238, 170, 156),
    (240, 173, 160),
    (134, 48, 32),
    (242, 231, 229),
    (134, 38, 23),
    (245, 57, 28),
    (240, 63, 36),
    (243, 59, 31),
    (242, 62, 35),
    (241, 60, 34),
    (240, 90, 70),
    (241, 118, 102),
    (241, 86, 66),
    (242, 90, 71),
    (242, 185, 178),
    (89, 38, 32),
    (222, 42, 24),
    (237, 51, 33),
    (240, 74, 58),
    (72, 37, 34),
    (92, 30, 25),
    (212, 37, 23),
    (241, 151, 144),
    (171, 55, 47),
    (90, 31, 27),
    (237, 59, 47),
    (189, 174, 173),
    (235, 38, 26),
    (172, 31, 24),
    (72, 51, 50),
    (72, 30, 28),
    (241, 144, 140),
    (236, 43, 36),
    (239, 175, 173),
    (242, 202, 201),
    (75, 46, 43),
    (237, 72, 69),
    (237, 51, 51),
    (93, 49, 49),
    ],
    "马卡龙/Macaron": [
    (255, 179, 186),
    (230, 230, 250),
    (216, 191, 216),
    (255, 182, 193),
    (255, 204, 204),
    (255, 229, 204),
    (255, 240, 245),
    (240, 248, 255),
    (204, 255, 204),
    (224, 255, 255),
    (204, 255, 255),
    (221, 160, 221),
    (255, 182, 193),
    (255, 160, 122),
    (255, 228, 181),
    (255, 218, 185),
    (255, 192, 203),
    (255, 228, 225),
    (255, 240, 245),
    (255, 228, 181),
    (255, 218, 185),
    (255, 192, 203),
    (255, 228, 225),
    (255, 240, 245),
    (255, 228, 181),
    (255, 218, 185),
    (255, 192, 203),
    (255, 228, 225),
    (255, 240, 245),
    (255, 228, 181),
    (255, 218, 185),
    (255, 192, 203),
    (255, 228, 225)
    ],
    "莫兰迪/Morandi": [
    (234, 209, 220),
    (224, 163, 183),
    (250, 177, 160),
    (255, 204, 188),
    (255, 229, 180),
    (240, 228, 163),
    (213, 214, 160),
    (181, 206, 168),
    (165, 184, 153),
    (139, 163, 151),
    (128, 142, 144),
    (144, 164, 174),
    (171, 184, 193),
    (198, 208, 215),
    (222, 235, 247),
    (203, 219, 219),
    (183, 201, 206),
    (168, 187, 204),
    (153, 174, 195),
    (139, 161, 184),
    (128, 148, 176),
    (149, 165, 182),
    (170, 180, 191),
    (191, 195, 204),
    (212, 210, 219),
    (233, 225, 236),
    (244, 238, 247),
    (248, 242, 247),
    (242, 236, 246),
    (233, 229, 245),
    (224, 222, 243),
    (215, 215, 241),
    (206, 208, 239),
    (197, 201, 237),
    (188, 194, 235)
    ],  
    "孟菲斯/Memphis": [
    (255, 64, 64),
    (255, 192, 203),
    (255, 105, 180),
    (255, 182, 193),
    (255, 20, 147),
    (220, 20, 60),
    (255, 99, 71),
    (255, 165, 0),
    (255, 215, 0),
    (255, 228, 181),
    (255, 250, 205),
    (255, 255, 0),
    (238, 232, 170),
    (173, 255, 47),
    (127, 255, 0),
    (0, 255, 127),
    (173, 216, 230),
    (135, 206, 235),
    (0, 191, 255),
    (176, 196, 222),
    (106, 90, 205),
    (138, 43, 226),
    (123, 104, 238),
    (75, 0, 130),
    (147, 112, 219),
    (139, 0, 139),
    (218, 112, 214),
    (255, 0, 255),
    (199, 21, 133),
    (255, 182, 193),
    (255, 105, 180),
    (255, 20, 147),
    (220, 20, 60)
    ],  
    "蒙德里安/Mondrian": [
    (255, 255, 255),  # 白色
    (0, 0, 0),        # 黑色
    (255, 0, 0),      # 红色
    (0, 128, 192),    # 蓝色
    (255, 255, 0),    # 黄色
    (128, 128, 128),  # 灰色
    (255, 128, 0)     # 橙色
    ],
    "灰度/Grayscale": [
    (0, 0, 0),
    (4, 4, 4),
    (8, 8, 8),
    (12, 12, 12),
    (16, 16, 16),
    (20, 20, 20),
    (24, 24, 24),
    (28, 28, 28),
    (32, 32, 32),
    (36, 36, 36),
    (40, 40, 40),
    (44, 44, 44),
    (48, 48, 48),
    (52, 52, 52),
    (56, 56, 56),
    (60, 60, 60),
    (64, 64, 64),
    (68, 68, 68),
    (72, 72, 72),
    (76, 76, 76),
    (80, 80, 80),
    (84, 84, 84),
    (88, 88, 88),
    (92, 92, 92),
    (96, 96, 96),
    (100, 100, 100),
    (104, 104, 104),
    (108, 108, 108),
    (112, 112, 112),
    (116, 116, 116),
    (120, 120, 120),
    (124, 124, 124),
    (128, 128, 128),
    (132, 132, 132),
    (136, 136, 136),
    (140, 140, 140),
    (144, 144, 144),
    (148, 148, 148),
    (152, 152, 152),
    (156, 156, 156),
    (160, 160, 160),
    (164, 164, 164),
    (168, 168, 168),
    (172, 172, 172),
    (176, 176, 176),
    (180, 180, 180),
    (184, 184, 184),
    (188, 188, 188),
    (192, 192, 192),
    (196, 196, 196),
    (200, 200, 200),
    (204, 204, 204),
    (208, 208, 208),
    (212, 212, 212),
    (216, 216, 216),
    (220, 220, 220),
    (224, 224, 224),
    (228, 228, 228),
    (232, 232, 232),
    (236, 236, 236),
    (240, 240, 240),
    (244, 244, 244),
    (248, 248, 248),
    (252, 252, 252),
    (255, 255, 255)
    ]

}

# 语言字典
language_dict = {
    "中文": {
        "title": "图片生成器",
        "preset_label": "选择预设颜色集合:",
        "custom_colors_label": "输入自定义颜色集合 (RGB格式):",
        "preview_button": "预览",
        "generate_button": "生成图片",
        "notes": "注意事项：\n1. 自定义颜色集合应为Python列表格式，例如：[(255, 0, 0), (0, 255, 0), (0, 0, 255)]。\n2. 颜色集合长度不能超过64。",
        "error_custom_format": "自定义颜色集合格式错误",
        "error_custom_length": "自定义颜色集合必须是一个列表，且长度不超过64",
        "error_preset": "请选择一个预设颜色集合",
        "success": "图片已保存为 OriginCube_BaseColor.png",
        "preview_label": "预览图"
    },
    "English": {
        "title": "Image Generator",
        "preset_label": "Select Preset Color Set:",
        "custom_colors_label": "Enter Custom Color Set (RGB format):",
        "preview_button": "Preview",
        "generate_button": "Generate Image",
        "notes": "Notes:\n1. Custom color set should be in Python list format, e.g., [(255, 0, 0), (0, 255, 0), (0, 0, 255)].\n2. The length of the color set cannot exceed 64.",
        "error_custom_format": "Custom color set format error",
        "error_custom_length": "Custom color set must be a list and its length cannot exceed 64",
        "error_preset": "Please select a preset color set",
        "success": "Image saved as OriginCube_BaseColor.png",
        "preview_label": "Preview Image"
    }
}

# 当前语言
current_language = "中文"

# 切换语言
def switch_language():
    global current_language
    if current_language == "中文":
        current_language = "English"
    else:
        current_language = "中文"
    update_ui_language()

# 更新界面语言
def update_ui_language():
    lang = language_dict[current_language]
    root.title(lang["title"])
    preset_label.config(text=lang["preset_label"])
    custom_colors_label.config(text=lang["custom_colors_label"])
    preview_button.config(text=lang["preview_button"])
    generate_button.config(text=lang["generate_button"])
    notes_label.config(text=lang["notes"])
    preview_text_label.config(text=lang["preview_label"])

# 全局变量存储预览图片
preview_image = None

# 生成图片
def generate_image(save=False):
    global preview_image  # 声明全局变量
    if save:
        if preview_image:
            # 选择保存路径和文件名
            file_path = filedialog.asksaveasfilename(
                title=language_dict[current_language]["success"],
                defaultextension=".png",
                initialfile="OriginCube_BaseColor.png",
                filetypes=[("PNG files", "*.png"), ("All files", "*.*")]
            )
            if file_path:
                # 扩展预览图片到原始大小
                original_image = preview_image.resize((512, 512), Image.LANCZOS)
                original_image.save(file_path)
                messagebox.showinfo(language_dict[current_language]["success"], f"{language_dict[current_language]['success']} {file_path}")
    else:
        # 获取用户输入的颜色集合
        custom_colors = custom_colors_entry.get().strip()
        if custom_colors:
            try:
                custom_colors = eval(custom_colors)  # 将字符串转换为列表
                if not isinstance(custom_colors, list) or len(custom_colors) > 64:
                    messagebox.showerror(language_dict[current_language]["error_custom_length"], "")
                    return
            except:
                messagebox.showerror(language_dict[current_language]["error_custom_format"], "")
                return
        else:
            # 使用预设颜色集合
            selected_preset = preset_var.get()
            if selected_preset not in preset_colors:
                messagebox.showerror(language_dict[current_language]["error_preset"], "")
                return
            custom_colors = preset_colors[selected_preset]

        # 创建512x512的图片
        image = Image.new("RGB", (512, 512), (255, 255, 255))
        draw = ImageDraw.Draw(image)

        # 绘制64个方块
        for i in range(8):
            for j in range(8):
                x0 = i * 64
                y0 = j * 64
                x1 = x0 + 64
                y1 = y0 + 64
                color = random.choice(custom_colors)
                draw.rectangle([x0, y0, x1, y1], fill=color)

        # 显示图片预览
        image_preview = image.resize((256, 256))  # 缩小图片以便预览
        img_tk = ImageTk.PhotoImage(image_preview)
        preview_label.config(image=img_tk)
        preview_label.image = img_tk

        # 保存预览图片到全局变量
        preview_image = image

# 更新预设颜色预览
def update_preset_preview():
    selected_preset = preset_var.get()
    if selected_preset in preset_colors:
        colors = preset_colors[selected_preset]
        for i in range(64):
            color = colors[i % len(colors)]
            preset_preview_canvas.itemconfig(preset_preview_rectangles[i], fill=f'#{color[0]:02x}{color[1]:02x}{color[2]:02x}')
    else:
        # 默认显示黑色
        for rect in preset_preview_rectangles:
            preset_preview_canvas.itemconfig(rect, fill="black")

# 创建主窗口
root = tk.Tk()
root.title(language_dict[current_language]["title"])

# 中英文切换按钮
language_button = tk.Button(root, text="中/EN", command=switch_language)
language_button.grid(row=0, column=0, padx=10, pady=10)

# 预设选择栏
preset_label = tk.Label(root, text=language_dict[current_language]["preset_label"])
preset_label.grid(row=1, column=0, padx=10, pady=10)

preset_var = tk.StringVar(value="中国500色/CN500-Color")
preset_option = tk.OptionMenu(root, preset_var, *preset_colors.keys(), command=lambda _: update_preset_preview())
preset_option.grid(row=1, column=1, padx=10, pady=10)

# 预设颜色预览区域
preset_preview_frame = tk.Frame(root)
preset_preview_frame.grid(row=2, column=0, columnspan=2, padx=10, pady=10)

preset_preview_canvas = tk.Canvas(preset_preview_frame, width=256, height=64)
preset_preview_canvas.pack()

preset_preview_rectangles = []
for i in range(16):
    for j in range(4):
        x0 = i * 16
        y0 = j * 16
        x1 = x0 + 16
        y1 = y0 + 16
        rect = preset_preview_canvas.create_rectangle(x0, y0, x1, y1, fill="white")
        preset_preview_rectangles.append(rect)

# 自定义颜色输入框
custom_colors_label = tk.Label(root, text=language_dict[current_language]["custom_colors_label"])
custom_colors_label.grid(row=3, column=0, padx=10, pady=10)

custom_colors_entry = tk.Entry(root, width=50)
custom_colors_entry.grid(row=3, column=1, padx=10, pady=10)

# 预览按钮
preview_button = tk.Button(root, text=language_dict[current_language]["preview_button"], command=lambda: generate_image(False))
preview_button.grid(row=4, column=0, padx=10, pady=10)

# 生成图片按钮
generate_button = tk.Button(root, text=language_dict[current_language]["generate_button"], command=lambda: generate_image(True))
generate_button.grid(row=4, column=1, padx=10, pady=10)

# 图片预览区域
preview_frame = tk.Frame(root)
preview_frame.grid(row=0, column=2, rowspan=5, padx=10, pady=10)

# 初始黑色预览图
initial_image = Image.new("RGB", (256, 256), (0, 0, 0))
initial_img_tk = ImageTk.PhotoImage(initial_image)
preview_label = tk.Label(preview_frame, image=initial_img_tk)
preview_label.pack()

# 预览图文字标注
preview_text_label = tk.Label(preview_frame, text=language_dict[current_language]["preview_label"])
preview_text_label.pack()

# 注意事项
notes_label = tk.Label(root, text=language_dict[current_language]["notes"], justify=tk.LEFT)
notes_label.grid(row=5, column=0, columnspan=3, padx=10, pady=10)

# 初始化预设颜色预览
update_preset_preview()

# 运行主循环
root.mainloop()